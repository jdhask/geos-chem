! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
! 
! Global Data Module File
! 
! Generated by KPP-2.3.0_gc symbolic chemistry Kinetics PreProcessor
!       (http://www.cs.vt.edu/~asandu/Software/KPP)
! KPP is distributed under GPL, the general public licence
!       (http://www.gnu.org/copyleft/gpl.html)
! (C) 1995-1997, V. Damian & A. Sandu, CGRER, Univ. Iowa
! (C) 1997-2005, A. Sandu, Michigan Tech, Virginia Tech
!     With important contributions from:
!        M. Damian, Villanova University, USA
!        R. Sander, Max-Planck Institute for Chemistry, Mainz, Germany
! 
! File                 : gckpp_Global.F90
! Equation file        : gckpp.kpp
! Output root filename : gckpp
! 
! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



MODULE gckpp_Global

  USE gckpp_Parameters, ONLY: dp, NSPEC, NVAR, NFIX, NREACT
  PUBLIC
  SAVE


! Declaration of global variables

! C - Concentration of all species
  REAL(kind=dp) :: C(NSPEC)
! VAR - Concentrations of variable species (global)
  REAL(kind=dp) :: VAR(NVAR)
! FIX - Concentrations of fixed species (global)
  REAL(kind=dp) :: FIX(NFIX)
! VAR, FIX are chunks of array C
!      EQUIVALENCE( C(1),VAR(1) )
!      EQUIVALENCE( C(267),FIX(1) )
! RCONST - Rate constants (global)
  REAL(kind=dp) :: RCONST(NREACT)
! TIME - Current integration time
  REAL(kind=dp) :: TIME
! SUN - Sunlight intensity between [0,1]
  REAL(kind=dp) :: SUN
! TEMP - Temperature
  REAL(kind=dp) :: TEMP
! RTOLS - (scalar) Relative tolerance
  REAL(kind=dp) :: RTOLS
! TSTART - Integration start time
  REAL(kind=dp) :: TSTART
! TEND - Integration end time
  REAL(kind=dp) :: TEND
! DT - Integration step
  REAL(kind=dp) :: DT
! ATOL - Absolute tolerance
  REAL(kind=dp) :: ATOL(NVAR)
! RTOL - Relative tolerance
  REAL(kind=dp) :: RTOL(NVAR)
! STEPMIN - Lower bound for integration step
  REAL(kind=dp) :: STEPMIN
! STEPMAX - Upper bound for integration step
  REAL(kind=dp) :: STEPMAX
! CFACTOR - Conversion factor for concentration units
  REAL(kind=dp) :: CFACTOR

! INLINED global variable declarations

  !-----------------------------------------------------------------------
  ! Declare KPP variables that are defined above as THREADPRIVATE
  ! as they are updated for each iteration w/in a parallel loop
  !-----------------------------------------------------------------------
  !$OMP THREADPRIVATE( C, VAR, FIX, RCONST, TIME, TEMP, CFACTOR )

  !-----------------------------------------------------------------------
  ! Add parameters to isolate a box for debugging
  !-----------------------------------------------------------------------
  INTEGER,       PARAMETER :: I_dbg = 50
  INTEGER,       PARAMETER :: J_dbg = 2
  INTEGER,       PARAMETER :: L_dbg = 44

  !-----------------------------------------------------------------------
  ! Add more inlined global parameters for heterogeneous chemistry here
  !-----------------------------------------------------------------------

  ! Minimum heterogeneous chemistry lifetime and reaction rate
  REAL(kind=dp), PARAMETER :: HetMinLife  = 1.e-3_dp
  REAL(kind=dp), PARAMETER :: HetMinRate  = 1.0_dp / HetMinLife

  ! Critical RH for uptake of GLYX, MGLYX, and GLYC:
  REAL(kind=dp), PARAMETER :: CRITRH      = 35.0e+0_dp

  ! Effective Henry's Law constant of IEPOX for reactive
  ! uptake to aqueous aerosols (M/atm)
  REAL(kind=dp), PARAMETER :: HSTAR_EPOX  = 1.7e+7_dp

  ! Conversion factor from atm to bar
  REAL(kind=dp), PARAMETER :: con_atm_bar = 1.0_dp / 1.01325_dp

  ! Universal gas consatant [bar/(mol/kg)/K]  (Source: NIST, 2014)
  ! NOTE: Make sure this is consistent w/ the value in physconsts.F90!
  REAL(kind=dp), PARAMETER :: con_R       = 0.083144598_dp

  !--------------------------------------------------------------------------
  ! Add more global variables here, so that they can be used
  ! in inlined functions that will get written to gckpp_Rates.F90
  !--------------------------------------------------------------------------

  !%% OGICALS %%%%

  LOGICAL :: NATSURFACE, PSCBOX, STRATBOX
  !$OMP THREADPRIVATE( NATSURFACE, PSCBOX, STRATBOX )

  !%% INTEGERS %%%%

  INTEGER :: NAEROTYPE
  !$OMP THREADPRIVATE( NAEROTYPE )

  !%% REALS %%%%

  ! Fine SSA+SNA aerosol area [cm2 aerosol/cm3 air]
  REAL(kind=dp) :: AClAREA
  !$OMP THREADPRIVATE( AClAREA )

  ! Fine SSA+SNA aerosol radius [cm]
  REAL(kind=dp) :: AClRADI
  !$OMP THREADPRIVATE( AClRADI )

  ! Fine SSA+SNA aerosol volume (cm3 aerosol/cm3 air)
  REAL(kind=dp) :: AClVOL
  !$OMP THREADPRIVATE( AClVol )

  ! Isorropia aerosol water (coarse & fine modes)
  REAL(kind=dp) :: AWATER(2)
  !$OMP THREADPRIVATE( AWATER )

  ! Proton activity [unitless] and H+ concentration [M]
  ! (assumed equivalent - for now):
  REAL(kind=dp) :: GAMMA_HO2
  !$OMP THREADPRIVATE( GAMMA_HO2 )

  ! H2O concentration
  REAL(kind=dp) :: H2O
  !$OMP THREADPRIVATE( H2O )

  ! Array for heterogeneous rates
  REAL(kind=dp) :: HET(NSPEC,8)
  !$OMP THREADPRIVATE( HET )

  ! Proton activity [unitless] and H+ concentration [M]
  ! (assumed equivalent - for now):
  REAL(kind=dp) :: H_PLUS
  !$OMP THREADPRIVATE( H_PLUS )

  ! KHETI_SLA = sticking coefficients for PSC reactions on SLA
  REAL(kind=dp) :: KHETI_SLA(11)
  !$OMP THREADPRIVATE( KHETI_SLA )

  ! Bisulfate (general acid), nitrate, sulfate concentrations [M]:
  REAL(kind=dp) :: MHSO4, MNO3, MSO4
  !$OMP THREADPRIVATE( MHSO4, MNO3, MSO4 )

  ! Number density
  REAL(kind=dp) :: NUMDEN
  !$OMP THREADPRIVATE( NUMDEN )

  ! Array for photolysis rates
  REAL(kind=dp) :: PHOTOL(1000)
  !$OMP THREADPRIVATE( PHOTOL )

  ! Ice and water mixing ratios (kg ice/kg dry air)
  REAL(kind=dp) :: QICE, QLIQ
  !$OMP THREADPRIVATE( QICE, QLIQ )

  ! Organic mattter to organic carbon ratios
  REAL(kind=dp) :: OMOC_POA, OMOC_OPOA
  !$OMP THREADPRIVATE( OMOC_POA, OMOC_OPOA )

  ! Pressure and relative humidity
  REAL(kind=dp) :: PRESS, RELHUM
  !$OMP THREADPRIVATE( PRESS, RELHUM )

  ! Aerosol concentrations
  REAL(kind=dp) :: SPC_SALA
  !$OMP THREADPRIVATE( SPC_SALA )

  ! Cosine of solar zenith angle
  REAL(kind=dp) :: SUNCOS
  !$OMP THREADPRIVATE( SUNCOS )

  ! Volume of air (cm3)
  REAL(kind=dp) :: VAir
  !$OMP THREADPRIVATE( Vair )

  ! Aerosol specific surface area (cm3 H2O/cm3 air)
  REAL(kind=dp) :: XAREA(25)
  !$OMP THREADPRIVATE( XAREA )

  ! Dry air density [molec/cm3]
  REAL(kind=dp) :: XDENA
  !$OMP THREADPRIVATE( XDENA )

  ! Aerosol water content, cm3(H2O)/cm3(air)
  REAL(kind=dp) :: XH2O(25)
  !$OMP THREADPRIVATE( XH2O )

  ! Aerosol effective radius (cm)
  REAL(kind=dp) :: XRADI(25)
  !$OMP THREADPRIVATE( XRADI )

  ! Square root of temperature [K]
  REAL(kind=dp) :: XTEMP
  !$OMP THREADPRIVATE( XTEMP )

  ! Aerosol specific volume, cm3(aerosol)/cm3(air)
  REAL(kind=dp) :: XVOL(25)
  !$OMP THREADPRIVATE( XVOL )


! INLINED global variable declarations


END MODULE gckpp_Global

